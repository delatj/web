<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Engranajes - Distancia (R1+R2)*4</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 5px; background-color: #f0f0f0; }
        .no-print { text-align: center; padding: 10px; background: white; margin-bottom: 5px; }
        .page { width: 210mm; height: 290mm; padding: 10mm; margin: 0 auto; background: white; box-sizing: border-box; display: flex; flex-direction: column; }
        .ejercicios-container { flex-grow: 1; display: flex; flex-direction: column; }
        .ejercicio-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; border-bottom: 1.5px dashed #aaa; padding: 8px 0; }
        .col { border: 2px solid #000; padding: 10px; display: flex; flex-direction: column; justify-content: space-between; }
        .gear-container { width: 100%; height: 100px; }
        .data-grid { display: grid; grid-template-columns: 1fr 1fr; font-size: 13px; border-top: 2px solid #000; padding-top: 8px; margin-top: 6px; font-weight: bold; }
        .soluciones { border-top: 3px solid #000; padding-top: 8px; font-size: 11px; margin-top: auto; }
        .soluciones-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; font-weight: bold; }
        @media print { .no-print { display: none; } .page { border: none; margin: 0; } }
    </style>
</head>
<body>

<div class="no-print">
    <button onclick="generar()" style="padding: 10px 20px; cursor: pointer; font-weight: bold;">Generar Nuevos Datos</button>
    <button onclick="window.print()" style="padding: 10px 20px; cursor: pointer; background: #28a745; color: white;">Imprimir en PDF</button>
</div>

<div class="page">
    <div id="ejercicios-box" class="ejercicios-container"></div>
    <div class="soluciones">
        <div style="font-weight: bold; margin-bottom: 5px;">SOLUCIONES (Z1·N1 = Z2·N2):</div>
        <div id="soluciones-box" class="soluciones-grid"></div>
    </div>
</div>

<script>
    function drawGears(z1, z2) {
        // 1. Calculamos radios visuales proporcionales a Z.
        // Reducimos el factor para que al multiplicar la distancia por 4 no se corte el dibujo.
        const factorEscala = 35 / (z1 + z2); 
        const r1 = z1 * factorEscala;
        const r2 = z2 * factorEscala;

        // 2. DISTANCIA ENTRE EJES = (R1 + R2) * 4
        const distanciaCentros = (r1 + r2) * 1;
        
        // 3. Centramos horizontalmente en el espacio de 200px
        const startX = (200 - distanciaCentros) / 2;

        return `
        <svg viewBox="0 0 200 100" class="gear-container">
            <g transform="translate(${startX}, 50)">
                <circle r="${r1}" fill="none" stroke="black" stroke-width="1.5" stroke-dasharray="3,2" />
                <circle r="${r1 * 0.75}" fill="white" stroke="black" stroke-width="1" />
                <circle r="2" fill="black" />
                <text x="-10" y="${r1 + 15}" font-size="11" font-weight="bold">Z1</text>
            </g>

            <g transform="translate(${startX + distanciaCentros}, 50)">
                <circle r="${r2}" fill="none" stroke="black" stroke-width="1.5" stroke-dasharray="3,2" />
                <circle r="${r2 * 0.75}" fill="white" stroke="black" stroke-width="1" />
                <circle r="2" fill="black" />
                <text x="-10" y="${r2 + 15}" font-size="11" font-weight="bold">Z2</text>
            </g>
        </svg>`;
    }

    function generar() {
        const eBox = document.getElementById('ejercicios-box');
        const sBox = document.getElementById('soluciones-box');
        eBox.innerHTML = ''; sBox.innerHTML = '';
        const letras = ['a', 'b', 'c', 'd', 'e'];

        letras.forEach(letra => {
            let z1 = (Math.floor(Math.random() * 10) + 5) * 2; 
            let z2 = (Math.floor(Math.random() * 10) + 5) * 2;
            let n1 = (Math.floor(Math.random() * 10) + 2) * 500;
            let n2 = (z1 * n1) / z2;
            let i = (z1 / z2).toFixed(2);

            const vars = ['Z1', 'N1', 'Z2', 'N2'];
            const inc = vars[Math.floor(Math.random() * vars.length)];
            let res = (inc === 'Z1') ? z1 : (inc === 'N1') ? n1 : (inc === 'Z2') ? z2 : n2;

            const bloque = `
                <div class="col">
                    <div style="font-weight:bold; font-size:16px;">${letra.toUpperCase()})</div>
                    ${drawGears(z1, z2)}
                    <div class="data-grid">
                        <div>Z1 = ${inc === 'Z1' ? '?' : z1 + ' d'}</div>
                        <div>N1 = ${inc === 'N1' ? '?' : n1 + ' rpm'}</div>
                        <div>Z2 = ${inc === 'Z2' ? '?' : z2 + ' d'}</div>
                        <div>N2 = ${inc === 'N2' ? '?' : n2.toFixed(0) + ' rpm'}</div>
                        <div style="color:blue">i = ?</div>
                    </div>
                </div>`;
            
            const fila = document.createElement('div');
            fila.className = 'ejercicio-row';
            fila.innerHTML = bloque + bloque + bloque;
            eBox.appendChild(fila);
            sBox.innerHTML += `<div>${letra.toUpperCase()}: ${inc}=${res.toFixed(0)}, i=${i}</div>`;
        });
    }
    window.onload = generar;
</script>
</body>
</html>
