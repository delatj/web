<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Generador de Poleas - A4 Optimizado</title>
    <style>
        /* Estilos base y reducción de márgenes exteriores */
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f0f0f0; }
        
        .no-print { 
            text-align: center; padding: 10px; background: white; 
            margin-bottom: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
        }

        /* Configuración de la página A4 con márgenes mínimos (5mm) */
        .page { 
            width: 210mm; 
            height: 296mm; 
            padding: 5mm; 
            margin: 0 auto; 
            background: white; 
            box-sizing: border-box; 
            display: flex; 
            flex-direction: column;
        }

        .ejercicios-container { flex-grow: 1; display: flex; flex-direction: column; }

        /* Filas ajustadas para maximizar espacio */
        .ejercicio-row { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 8px; 
            border-bottom: 1px dashed #bbb; 
            padding: 6px 0;
        }

        /* Cuadros de ejercicio con borde más grueso */
        .col { 
            border: 2px solid #000; 
            padding: 8px; 
            display: flex; 
            flex-direction: column; 
            justify-content: space-between;
        }

        .header-letra { font-weight: bold; font-size: 16px; margin-bottom: 2px; }
        
        .pulley-container { width: 100%; height: 90px; }
        
        /* DATOS A 16px Y NEGRITA */
        .data-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            font-size: 16px; 
            border-top: 2px solid #000; 
            padding-top: 6px; 
            margin-top: 4px;
            font-weight: bold;
        }

        .soluciones { 
            border-top: 3px solid #000; 
            padding-top: 8px; 
            font-size: 12px; 
            margin-top: auto; 
        }

        .soluciones-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; font-weight: bold; }

        button { 
            padding: 10px 20px; font-size: 16px; cursor: pointer; 
            background-color: #007bff; color: white; border: none; border-radius: 4px; font-weight: bold;
        }

        @media print {
            .no-print { display: none; }
            body { background: white; padding: 0; }
            .page { border: none; margin: 0; width: 100%; height: 297mm; }
        }
    </style>
</head>
<body>

<div class="no-print">
    <button onclick="generar()">Generar Nuevos Números</button>
    <button onclick="window.print()" style="background-color: #28a745; margin-left: 10px;">Imprimir PDF</button>
</div>

<div class="page">
    <div id="ejercicios-box" class="ejercicios-container"></div>
    
    <div class="soluciones">
        <div style="font-weight: bold; text-decoration: underline; margin-bottom: 5px; font-size: 14px;">SOLUCIONES (D1·N1 = D2·N2 e i):</div>
        <div id="soluciones-box" class="soluciones-grid"></div>
    </div>
</div>

<script>
    function drawPulleys(d1, d2) {
        // Normalización visual para el gráfico
        const r1 = Math.max(10, Math.min(25, d1 / 3.5));
        const r2 = Math.max(10, Math.min(25, d2 / 3.5));
        
        return `
        <svg viewBox="0 0 200 100" class="pulley-container">
            <line x1="55" y1="${50 - r1}" x2="145" y2="${50 - r2}" stroke="black" stroke-width="1.5" />
            <line x1="55" y1="${50 + r1}" x2="145" y2="${50 + r2}" stroke="black" stroke-width="1.5" />
            <circle cx="55" cy="50" r="${r1}" fill="white" stroke="black" stroke-width="2" />
            <circle cx="55" cy="50" r="2.5" fill="black" />
            <circle cx="145" cy="50" r="${r2}" fill="white" stroke="black" stroke-width="2" />
            <circle cx="145" cy="50" r="2.5" fill="black" />
            <text x="45" y="${50 + r1 + 18}" font-size="12" font-weight="bold">P1</text>
            <text x="135" y="${50 + r2 + 18}" font-size="12" font-weight="bold">P2</text>
        </svg>`;
    }

    function generar() {
        const eBox = document.getElementById('ejercicios-box');
        const sBox = document.getElementById('soluciones-box');
        eBox.innerHTML = ''; sBox.innerHTML = '';
        const letras = ['a', 'b', 'c', 'd', 'e'];

        letras.forEach(letra => {
            let d1 = (Math.floor(Math.random() * 9) + 2) * 10; 
            let n1 = (Math.floor(Math.random() * 20) + 5) * 100; 
            let d2 = (Math.floor(Math.random() * 9) + 2) * 10; 
            let n2 = (d1 * n1) / d2;

            const vars = ['D1', 'N1', 'D2', 'N2'];
            const inc = vars[Math.floor(Math.random() * vars.length)];

            let valInc = (inc === 'D1') ? d1 : (inc === 'N1') ? n1 : (inc === 'D2') ? d2 : n2;
            const i = (n2 / n1).toFixed(2);

            const bloque = `
                <div class="col">
                    <div class="header-letra">${letra.toUpperCase()})</div>
                    ${drawPulleys(d1, d2)}
                    <div class="data-grid">
                        <div>D1=${inc === 'D1' ? '?' : d1 + 'mm'}</div>
                        <div>N1=${inc === 'N1' ? '?' : n1 + 'rpm'}</div>
                        <div>D2=${inc === 'D2' ? '?' : d2 + 'mm'}</div>
                        <div>N2=${inc === 'N2' ? '?' : n2.toFixed(0) + 'rpm'}</div>
                        <div style="color:blue">i=?</div>
                    </div>
                </div>`;
            
            const fila = document.createElement('div');
            fila.className = 'ejercicio-row';
            fila.innerHTML = bloque + bloque + bloque;
            eBox.appendChild(fila);

            sBox.innerHTML += `<div>${letra.toUpperCase()}: ${inc}=${valInc.toFixed(0)}, i=${i}</div>`;
        });
    }

    window.onload = generar;
</script>
</body>
</html>